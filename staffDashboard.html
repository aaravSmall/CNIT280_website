<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>City Dome & Convention Center</title>
  <style>
    body { font-family: Arial, sans-serif; margin:0; background:#f4f4f9; color:#333; }
    header { background:#3b5d5b; color:white; padding:15px; display:flex; justify-content:space-between; align-items:center; }
    header h1 { margin:0; }
    nav { display:flex; justify-content:center; background:#ece0d7; padding:10px; gap:12px; }
    nav a { text-decoration:none; font-weight:bold; color:#31333e; }
    .container { max-width:900px; margin:24px auto; background:white; padding:20px; border-radius:10px; box-shadow:0 2px 6px rgba(0,0,0,0.08); }
    .roleNote { margin-top:8px; color:#555; font-size:0.95em; }
    .small { font-size:0.95em; color:#666; margin-top:10px; }
    #notifications { background:#f7f7f7; border-radius:8px; padding:10px; margin-top:15px; }
    select { border-radius:6px; padding:4px 6px; border:1px solid #ccc; }
  </style>
</head>
<body>
  <header>
    <div>
      <h1 data-i18n="title">City Dome & Convention Center</h1>
      <p id="roleLabel" style="margin:4px 0 0; font-weight:600;"></p>
    </div>
    <div>
      <label for="langSelect" style="font-size:0.9em;">üåê</label>
      <select id="langSelect">
        <option value="en">EN</option>
        <option value="es">ES</option>
        <option value="fr">FR</option>
      </select>
    </div>
  </header>

  <nav id="navBar"></nav>

  <div class="container">
    <h2 data-i18n="welcomeHeading">Welcome</h2>
    <p data-i18n="welcomeText">This is the prototype homepage. Use the menu above to navigate.</p>
    <p class="roleNote" id="roleNote"></p>
    <p class="small" data-i18n="quickLinks">Quick links: calendar, order form (customers), dashboards (admins/staff).</p>

    <div id="notifications"></div>
  </div>

  <script>
    const translations = {
      en: {
        title: "City Dome & Convention Center",
        welcomeHeading: "Welcome",
        welcomeText: "This is the prototype homepage. Use the menu above to navigate.",
        quickLinks: "Quick links: calendar, order form (customers), dashboards (admins/staff).",
        customerRoleNote: "You are logged in as CUSTOMER. Use \"Place an Order\" to schedule events (Nov 1‚Äì30, 2025).",
        adminRoleNote: "You are logged in as ADMIN. Manage the calendar and events here.",
        staffRoleNote: "You are logged in as STAFF. View events and update attendance/rating.",
        notifTitle: "Upcoming Events (Next 3 Days)",
        notifNone: "You have no upcoming events in the next 3 days.",
      },
      es: {
        title: "Centro de Convenciones City Dome",
        welcomeHeading: "Bienvenido",
        welcomeText: "Esta es la p√°gina de inicio del prototipo. Usa el men√∫ de arriba para navegar.",
        quickLinks: "Enlaces r√°pidos: calendario, formulario de reserva (clientes), paneles (administradores/personal).",
        customerRoleNote: "Has iniciado sesi√≥n como CLIENTE. Usa \"Realizar un pedido\" para programar eventos (1‚Äì30 de noviembre de 2025).",
        adminRoleNote: "Has iniciado sesi√≥n como ADMIN. Administra el calendario y los eventos aqu√≠.",
        staffRoleNote: "Has iniciado sesi√≥n como PERSONAL. Ve eventos y actualiza asistencia/calificaci√≥n.",
        notifTitle: "Pr√≥ximos eventos (pr√≥ximos 3 d√≠as)",
        notifNone: "No tienes eventos pr√≥ximos en los pr√≥ximos 3 d√≠as.",
      },
      fr: {
        title: "Centre de congr√®s City Dome",
        welcomeHeading: "Bienvenue",
        welcomeText: "Ceci est la page d‚Äôaccueil du prototype. Utilisez le menu ci-dessus pour naviguer.",
        quickLinks: "Liens rapides : calendrier, formulaire de r√©servation (clients), tableaux de bord (administrateurs/personnel).",
        customerRoleNote: "Vous √™tes connect√© en tant que CLIENT. Utilisez ¬´ Passer une commande ¬ª pour planifier des √©v√©nements (1‚Äì30 novembre 2025).",
        adminRoleNote: "Vous √™tes connect√© en tant qu‚ÄôADMIN. G√©rez le calendrier et les √©v√©nements ici.",
        staffRoleNote: "Vous √™tes connect√© en tant que MEMBRE DU PERSONNEL. Consultez les √©v√©nements et mettez √† jour la participation/la note.",
        notifTitle: "√âv√©nements √† venir (3 prochains jours)",
        notifNone: "Vous n‚Äôavez aucun √©v√©nement √† venir dans les 3 prochains jours.",
      }
    };

    const user = JSON.parse(localStorage.getItem('currentUser')||'null');
    const nav = document.getElementById('navBar');
    const roleLabel = document.getElementById('roleLabel');
    const roleNote = document.getElementById('roleNote');

    function renderNav(){
      if(!user){
        nav.innerHTML = `<a href="login.html">Login</a>`;
        roleLabel.textContent = 'Not logged in';
        roleNote.textContent = 'Please login to use the prototype.';
        return;
      }
      let html = `<a href="homePage.html">Home</a> <a href="calendar.html">Calendar</a> `;
      if(user.role === 'customer'){
        html += `<a href="orderForm.html">Place an Order</a> <a href="orderHistory.html">Order History</a>`;
      } else if(user.role === 'admin'){
        html += `<a href="adminDashboard.html">Admin Dashboard</a>`;
      } else if(user.role === 'staff'){
        html += `<a href="staffDashboard.html">Staff Dashboard</a>`;
      }
      html += ` <a href="login.html" onclick="logout(event)">Logout</a>`;
      nav.innerHTML = html;
      roleLabel.textContent = `${user.username} ‚Äî ${user.role.toUpperCase()}`;
    }

    function logout(e){
      e.preventDefault();
      localStorage.removeItem('currentUser');
      window.location.href = 'login.html';
    }

    function applyLanguage(lang){
      const t = translations[lang] || translations.en;
      document.querySelectorAll('[data-i18n]').forEach(el=>{
        const key = el.getAttribute('data-i18n');
        if(t[key]) el.textContent = t[key];
      });
      if(user){
        if(user.role === 'customer') roleNote.textContent = t.customerRoleNote;
        else if(user.role === 'admin') roleNote.textContent = t.adminRoleNote;
        else if(user.role === 'staff') roleNote.textContent = t.staffRoleNote;
      }
      // update notifications text if already rendered
      const notifBox = document.getElementById('notifications');
      if(notifBox.dataset.empty === 'true'){
        notifBox.innerHTML = `<h3>${t.notifTitle}</h3><p>${t.notifNone}</p>`;
      } else if(notifBox.dataset.title === 'set'){
        notifBox.querySelector('h3').textContent = t.notifTitle;
      }
    }

    // 901: client automated notifications
    function renderClientNotifications(){
      const notifBox = document.getElementById('notifications');
      if(!user || user.role!=='customer'){
        notifBox.innerHTML = '';
        return;
      }
      const events = JSON.parse(localStorage.getItem('events')||'[]');
      const now = new Date();
      const threeDaysAhead = new Date(now.getTime() + 3*24*60*60*1000);
      const myEvents = events.filter(e=>{
        if(!e.orderInfo || e.orderInfo.customer !== user.username) return false;
        if(!e.date || e.completed) return false;
        const d = new Date(e.date);
        return d >= now && d <= threeDaysAhead;
      });
      const lang = document.getElementById('langSelect').value || 'en';
      const t = translations[lang] || translations.en;

      if(!myEvents.length){
        notifBox.dataset.empty = 'true';
        notifBox.dataset.title = 'set';
        notifBox.innerHTML = `<h3>${t.notifTitle}</h3><p>${t.notifNone}</p>`;
        return;
      }
      notifBox.dataset.empty = 'false';
      notifBox.dataset.title = 'set';
      let html = `<h3>${t.notifTitle}</h3><ul>`;
      myEvents.forEach(e=>{
        html += `<li><strong>${e.orderInfo.name}</strong> ‚Äî ${e.orderInfo.type} on ${e.date}</li>`;
      });
      html += '</ul>';
      notifBox.innerHTML = html;
    }

    renderNav();

    const langSelect = document.getElementById('langSelect');
    langSelect.addEventListener('change', ()=>{
      const lang = langSelect.value;
      applyLanguage(lang);
      renderClientNotifications();
    });

    // initial
    applyLanguage('en');
    renderClientNotifications();
  </script>
</body>
</html>
